# # === MAINTENANCE MODE CONFIGURATION ===
# # Return 503 status code for maintenance page
# <IfModule mod_headers.c>
#     Header set X-Maintenance-Mode "active"
#     Header set Retry-After "86400"
# </IfModule>

# # Error document
# ErrorDocument 503 /index.html

# # Cache control for maintenance page
# <IfModule mod_headers.c>
#     <FilesMatch "\.(html|htm)$">
#         Header set Cache-Control "no-cache, no-store, must-revalidate"
#         Header set Pragma "no-cache"
#         Header set Expires "0"
#     </FilesMatch>
# </IfModule>

# === LAYER SECURITY TAMBAHAN ===

# 1. Matikan directory listing
Options -Indexes

# 2. Blokir akses file sensitif
<FilesMatch "(^\.env|\.git|composer\.json|composer\.lock|package\.json|package-lock\.json|config\.yml|config\.yaml|wp-config\.php|\.htaccess|\.htpasswd)">
    Order allow,deny
    Deny from all
</FilesMatch>

# 3. Cegah eksekusi file PHP di folder tertentu (contoh: uploads, jika ada)
<Directory "uploads">
    <FilesMatch "\.php$">
        Order allow,deny
        Deny from all
    </FilesMatch>
</Directory>

# 4. Blok akses folder subdomain via domain utama & Set 503 for maintenance
<IfModule mod_rewrite.c>
RewriteEngine On

# Set 503 status code for maintenance mode (root and index.html)
# RewriteCond %{REQUEST_URI} ^/index\.html$ [OR]
# RewriteCond %{REQUEST_URI} ^/$
# RewriteRule .* - [R=503,L]

# Kecuali favicon.ico dan ojs-dev
RewriteCond %{REQUEST_URI} !^/favicon\.ico$ [NC]
RewriteCond %{REQUEST_URI} !^/favicon\.png$ [NC]
RewriteCond %{REQUEST_URI} !^/ojs-dev/? [NC]

# Kecuali sitemaps dan robots.txt
RewriteCond %{REQUEST_URI} !^/sitemap\.xml$ [NC]
RewriteCond %{REQUEST_URI} !^/robots\.txt$ [NC]

# Cegah akses ke semua folder level-1 via domain utama
RewriteCond %{REQUEST_URI} ^/([^/]+)/?$
RewriteCond %{HTTP_HOST} ^(www\.)?mitracoretech\.id [NC]
RewriteRule ^ - [F]
</IfModule>

# php -- BEGIN cPanel-generated handler, do not edit
# Set the "ea-php83" package as the default "PHP" programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php83___lsphp .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
